<div class="panel panel-default no-border">

  <!-- Default panel contents -->
  <div class="panel-heading text-center logo">

    <div class="logged-user">
      <i class="fa fa-user"></i>
      <span>{{::home.getCurrentUser().name}}</span>
    </div>

    <img src="../../img/seahorse-main.png">
    <p class="api-version">v{{home.getVersion()}}</p>
  </div>
  <!-- List group -->
  <div class="btn-group btn-group-justified" role="group">
    <div class="btn-group" role="group">
      <button type="button" class="btn-yellow btn text-uppercase btn-workflow btn-workflow__new"
              ng-click="home.displayCreateWorkflowPopup($event)">New Workflow
      </button>
    </div>
    <div class="btn-group" role="group">
      <button type="button" class="btn-blue btn text-uppercase btn-workflow btn-workflow__upload"
              ng-click="home.displayUploadWorkflowPopup($event)">Upload Workflow
      </button>
    </div>
  </div>
  <deepsense-loading-spinner-sm ng-if="home.isWorkflowLoading()"></deepsense-loading-spinner-sm>
  <div class="input-group col-md-12" ng-if="home.getAllWorkflows()">
    <input type="text" class="text-center form-control input-search-workflow"
           ng-model="home.filterString" placeholder="SEARCH...">
  </div>
  <div ng-if="!home.isWorkflowLoading()">
    <table class="table table-striped text-center table-workflows">
      <tr class="header text-uppercase">
        <td class="col-md-1 color-gray">
          <b>No.</b>
        </td>
        <td class="col-md-2 color-gray sortable"
            ng-click="home.sortBy('name')">
          <b>Name</b>
          <span>
            <i ng-class="home.getClass('name')"></i>
          </span>
        </td>
        <td class="col-md-3 color-gray sortable"
            ng-click="home.sortBy('description')">
          <b>Description</b>
          <span>
            <i ng-class="home.getClass('description')"></i>
          </span>
        </td>
        <td class="col-md-2 color-gray sortable" ng-click="home.sortBy('updated')">
          <b>Updated</b>
          <span>
            <i ng-class="home.getClass('updated')"></i>
          </span>
        </td>
        <td class="col-md-2 color-gray sortable" ng-click="home.sortBy('ownerName')">
          <b>Owner name</b>
          <span>
            <i ng-class="home.getClass('ownerName')"></i>
          </span>
        </td>
        <td class="col-md-2 color-gray sortable" ng-click="home.sortBy('created')">
          <b>Created</b>
          <span>
            <i ng-class="home.getClass('created')"></i>
          </span>
        </td>
        <td class="col-md-2 color-gray">
          <b>Actions</b>
        </td>
      </tr>
      <tr ng-repeat="workflow in home.workflows |
                     orderBy : home.sort.column : home.sort.descending |
                     filter: { name: home.filterString } track by workflow.id">
        <td class="vertical-align">
          <a ng-click="home.goToWorkflowEditor(workflow.id)">
            {{$index+1}}
          </a>
        </td>
        <td class="vertical-align">
          <a ng-click="home.goToWorkflowEditor(workflow.id)">{{workflow.name}}</a>
        </td>
        <td class="vertical-align">
          <a ng-if="workflow.description"
             uib-popover="{{workflow.description}}"
             popover-trigger="{{ home.getTriggerEventBasedOnDescriptionLength(workflow.description) }}"
             popover-append-to-body="true"
             ng-click="home.goToWorkflowEditor(workflow.id)">
            {{workflow.description | cut : true : 50 : ' ...' }}
          </a>
          <a ng-if="workflow.description.length == 0"
             ng-click="home.goToWorkflowEditor(workflow.id)">
            -
          </a>
        </td>
        <td class="vertical-align">
          <a ng-click="home.goToWorkflowEditor(workflow.id)">
            {{workflow.updated | date:"dd/MM/yyyy - hh:mm a"}}
          </a>
        </td>
        <td class="vertical-align">
          <a ng-class="{
              'owned-by-current-user': home.isWorkflowOwnedByCurrentUser(workflow)
            }"
             ng-click="home.goToWorkflowEditor(workflow.id)">
            {{workflow.ownerName}}
          </a>
        </td>
        <td class="vertical-align">
          <a ng-click="home.goToWorkflowEditor(workflow.id)">
            {{workflow.created | date:"dd/MM/yyyy - hh:mm a"}}
          </a>
        </td>
        <td class="vertical-align action-icons">
          <a ng-if="workflow.sessionStatus === 'running' || workflow.sessionStatus === 'error'">
            <i ng-click="home.deleteSession(workflow.id)"
               ng-if="home.isWorkflowOwnedByCurrentUser(workflow)"
               uib-popover="Stop session"
               popover-trigger="mouseenter"
               popover-append-to-body="true"
               class="fa fa-power-off">
            </i>
          </a>
          <a popover-trigger="mouseenter"
             popover-placement="left"
             uib-popover="Clone workflow"
             ng-click="home.cloneWorkflow(workflow)">
            <span class="fa fa-files-o"></span>
          </a>
          <a popover-trigger="mouseenter"
             uib-popover="Delete workflow"
             ng-click="home.deleteWorkflow(workflow)">
            <span class="fa fa-times"></span>
          </a>
        </td>
      </tr>
    </table>
  </div>
  <div class="col-md-12" ng-if="!home.isWorkflowLoading() && home.isWorkflowListEmpty">
    <div class="container center">
      <div class="no-worfklows">
        <div class="no-worfklows__icon">
          <i class="fa fa-ban"></i>
          <span>No workflows found!</span>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12" ng-if="!home.isWorkflowLoading() && home.isErrorConnectingToVagrant">
    <div class="container center">
      <div class="no-worfklows">
        <div class="no-worfklows__icon">
          <span>
            <b>Seahorse is booting up.</b>
          </span>
          <br/>
          <span>Please wait a few seconds and <a href="#" ng-click="home.reloadPage()">reload the page</a>.</span>
        </div>
      </div>
    </div>
  </div>
</div>
