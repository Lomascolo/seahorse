{
  "workflow": {
    "nodes": [{
      "id": "9a1256c8-2453-658a-674a-b9bb0cc44751",
      "operation": {
        "id": "a88eaf35-9061-4714-b042-ddd2049ce917",
        "name": "Evaluate"
      },
      "parameters": {
        "Parameters of input Evaluator": {
          "metric": {
            "areaUnderPR": {

            }
          },
          "raw prediction column": {
            "type": "column",
            "value": "rawPrediction"
          },
          "label column": {
            "type": "column",
            "value": "class"
          }
        }
      }
    }, {
      "id": "c88df42d-7082-2709-5ad2-7cf9e1fa97cd",
      "operation": {
        "id": "3129848c-8a1c-449e-b006-340fec5b42ae",
        "name": "Multiclass Classification Evaluator"
      },
      "parameters": {
        "metric": {
          "f1": {

          }
        },
        "prediction column": {
          "type": "column",
          "value": "prediction"
        },
        "label column": {
          "type": "column",
          "value": "label"
        }
      }
    }, {
      "id": "d6d89982-bcf7-e65d-9df2-495cd8fc3876",
      "operation": {
        "id": "3fb50e0a-d4fb-474f-b6f3-679788068b1b",
        "name": "Tokenize With Regex"
      },
      "parameters": {
        "gaps": false,
        "min token length": 1.0,
        "pattern": "[a-zA-Z]+",
        "operate on": {
          "one column": {
            "input column": {
              "type": "column",
              "value": "text"
            },
            "output": {
              "replace input column": {

              }
            }
          }
        }
      }
    }, {
      "id": "d59b610d-7c5a-255f-2b08-b7b84ce6215f",
      "operation": {
        "id": "d273c42f-b840-4402-ba6b-18282cc68de3",
        "name": "Split"
      },
      "parameters": {
        "split ratio": 0.7,
        "seed": 0.0
      }
    }, {
      "id": "e9eec70d-55f1-0a51-ac73-8e40cef1f8b0",
      "operation": {
        "id": "e640d7df-d464-4ac0-99c4-235c29a0aa31",
        "name": "Count Vectorizer"
      },
      "parameters": {
        "min different documents": 1.0,
        "input column": {
          "type": "column",
          "value": "text"
        },
        "output column": "vector",
        "min term frequency": 1.0,
        "max vocabulary size": 262144.0
      }
    }, {
      "id": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
      "operation": {
        "id": "643d8706-24db-4674-b5b4-10b5129251fc",
        "name": "Transform"
      },
      "parameters": {
        "Parameters of input Transformer": {
          "features column": {
            "type": "column",
            "value": "vector"
          },
          "threshold": 0.1,
          "prediction column": "prediction",
          "probability column": "probability",
          "raw prediction column": "rawPrediction"
        }
      }
    }, {
      "id": "e6d42f1c-2589-a3d4-676b-df0c3b9b3bf7",
      "operation": {
        "id": "a88eaf35-9061-4714-b042-ddd2049ce917",
        "name": "Evaluate"
      },
      "parameters": {
        "Parameters of input Evaluator": {
          "metric": {
            "weightedPrecision": {

            }
          },
          "prediction column": {
            "type": "column",
            "value": "prediction"
          },
          "label column": {
            "type": "column",
            "value": "class"
          }
        }
      }
    }, {
      "id": "5169cfbd-079b-dfc1-ed05-73b4308d8a6b",
      "operation": {
        "id": "a721fe2a-5d7f-44b3-a1e7-aade16252ead",
        "name": "Custom Python Operation"
      },
      "parameters": {
        "code": "def transform(df):\n    text = df['text']\n    cls = df['class']\n    pred = df['prediction']\n    return df.select(text, cls, pred, (cls == pred).alias('correct'))"
      }
    }, {
      "id": "75a8c3fc-3ea6-853f-8c4e-c22c9d8128d9",
      "operation": {
        "id": "7f9e459e-3e11-4c5f-9137-94447d53ff60",
        "name": "Logistic Regression"
      },
      "parameters": {
        "features column": {
          "type": "column",
          "value": "te"
        },
        "tolerance": 0.0000010,
        "elastic net param": 0.0,
        "max iterations": 1.0,
        "regularization param": 0.0,
        "standardization": true,
        "threshold": 0.5,
        "label column": {
          "type": "column",
          "value": "label"
        },
        "prediction column": "prediction",
        "probability column": "probability",
        "fit intercept": true,
        "raw prediction column": "rawPrediction"
      }
    }, {
      "id": "8fe19680-d295-636d-c0c5-ce00b908ea1c",
      "operation": {
        "id": "0c2ff818-977b-11e5-8994-feff819cdc9f",
        "name": "Fit"
      },
      "parameters": {
        "Parameters of input Estimator": {
          "features column": {
            "type": "column",
            "value": "vector"
          },
          "tolerance": 0.000001,
          "elastic net param": 0,
          "max iterations": 100,
          "regularization param": 0,
          "standardization": true,
          "threshold": 0.1,
          "label column": {
            "type": "column",
            "value": "class"
          },
          "prediction column": "prediction",
          "probability column": "probability",
          "fit intercept": true,
          "raw prediction column": "rawPrediction"
        }
      }
    }, {
      "id": "96470bf5-4a9e-472e-3e4b-59cf42153bbb",
      "operation": {
        "id": "c48dd54c-6aef-42df-ad7a-42fc59a09f0e",
        "name": "Read DataFrame"
      },
      "parameters": {
        "data storage type": {
          "FILE": {
            "source": "https://s3.amazonaws.com/workflowexecutor/examples/data/SMSSpamCollection",
            "format": {
              "CSV": {
                "separator": {
                  "Tab": {

                  }
                },
                "names included": true,
                "convert to boolean": false
              }
            }
          }
        }
      }
    }, {
      "id": "759f34de-8bc0-9b0b-c72c-c78f103ddf1d",
      "operation": {
        "id": "643d8706-24db-4674-b5b4-10b5129251fc",
        "name": "Transform"
      },
      "parameters": {
        "Parameters of input Transformer": {
          "input column": {
            "type": "column",
            "value": "text"
          },
          "min term frequency": 1,
          "output column": "vector"
        }
      }
    }, {
      "id": "702dbca8-1f0c-d30f-d2fc-ca583bdbd1c5",
      "operation": {
        "id": "464ce3fa-e915-4a5d-a9d1-442c1e4b7aa7",
        "name": "Binary Classification Evaluator"
      },
      "parameters": {
        "metric": {
          "areaUnderPR": {

          }
        },
        "raw prediction column": {
          "type": "column",
          "value": "rawPrediction"
        },
        "label column": {
          "type": "column",
          "value": "label"
        }
      }
    }, {
      "id": "140504b9-a300-0b4c-cf80-2c1b8eb07bc2",
      "operation": {
        "id": "e76ca616-0322-47a5-b390-70c9668265dd",
        "name": "Notebook"
      },
      "parameters": {

      }
    }, {
      "id": "62890c24-2a94-c6ef-e068-136a914968b5",
      "operation": {
        "id": "c9df7000-9ea0-41c0-b66c-3062fd57851b",
        "name": "String Indexer"
      },
      "parameters": {
        "operate on": {
          "one column": {
            "input column": {
              "type": "column",
              "value": "class"
            },
            "output": {
              "replace input column": {

              }
            }
          }
        }
      }
    }],
    "connections": [{
      "from": {
        "nodeId": "d59b610d-7c5a-255f-2b08-b7b84ce6215f",
        "portIndex": 1
      },
      "to": {
        "nodeId": "759f34de-8bc0-9b0b-c72c-c78f103ddf1d",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "96470bf5-4a9e-472e-3e4b-59cf42153bbb",
        "portIndex": 0
      },
      "to": {
        "nodeId": "62890c24-2a94-c6ef-e068-136a914968b5",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
        "portIndex": 0
      },
      "to": {
        "nodeId": "e6d42f1c-2589-a3d4-676b-df0c3b9b3bf7",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "62890c24-2a94-c6ef-e068-136a914968b5",
        "portIndex": 0
      },
      "to": {
        "nodeId": "d6d89982-bcf7-e65d-9df2-495cd8fc3876",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "75a8c3fc-3ea6-853f-8c4e-c22c9d8128d9",
        "portIndex": 0
      },
      "to": {
        "nodeId": "8fe19680-d295-636d-c0c5-ce00b908ea1c",
        "portIndex": 1
      }
    }, {
      "from": {
        "nodeId": "d59b610d-7c5a-255f-2b08-b7b84ce6215f",
        "portIndex": 0
      },
      "to": {
        "nodeId": "e9eec70d-55f1-0a51-ac73-8e40cef1f8b0",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "8fe19680-d295-636d-c0c5-ce00b908ea1c",
        "portIndex": 0
      },
      "to": {
        "nodeId": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
        "portIndex": 1
      }
    }, {
      "from": {
        "nodeId": "759f34de-8bc0-9b0b-c72c-c78f103ddf1d",
        "portIndex": 0
      },
      "to": {
        "nodeId": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "702dbca8-1f0c-d30f-d2fc-ca583bdbd1c5",
        "portIndex": 0
      },
      "to": {
        "nodeId": "9a1256c8-2453-658a-674a-b9bb0cc44751",
        "portIndex": 1
      }
    }, {
      "from": {
        "nodeId": "e9eec70d-55f1-0a51-ac73-8e40cef1f8b0",
        "portIndex": 1
      },
      "to": {
        "nodeId": "759f34de-8bc0-9b0b-c72c-c78f103ddf1d",
        "portIndex": 1
      }
    }, {
      "from": {
        "nodeId": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
        "portIndex": 0
      },
      "to": {
        "nodeId": "140504b9-a300-0b4c-cf80-2c1b8eb07bc2",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "e9eec70d-55f1-0a51-ac73-8e40cef1f8b0",
        "portIndex": 0
      },
      "to": {
        "nodeId": "8fe19680-d295-636d-c0c5-ce00b908ea1c",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "c88df42d-7082-2709-5ad2-7cf9e1fa97cd",
        "portIndex": 0
      },
      "to": {
        "nodeId": "e6d42f1c-2589-a3d4-676b-df0c3b9b3bf7",
        "portIndex": 1
      }
    }, {
      "from": {
        "nodeId": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
        "portIndex": 0
      },
      "to": {
        "nodeId": "5169cfbd-079b-dfc1-ed05-73b4308d8a6b",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "d6d89982-bcf7-e65d-9df2-495cd8fc3876",
        "portIndex": 0
      },
      "to": {
        "nodeId": "d59b610d-7c5a-255f-2b08-b7b84ce6215f",
        "portIndex": 0
      }
    }, {
      "from": {
        "nodeId": "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de",
        "portIndex": 0
      },
      "to": {
        "nodeId": "9a1256c8-2453-658a-674a-b9bb0cc44751",
        "portIndex": 0
      }
    }]
  },
  "thirdPartyData": {
    "gui": {
      "name": "Text Message Spam Detection",
      "description": "Reducing the amount of text message spam in cellular networks",
      "predefColors": ["#00B1EB", "#1ab394", "#2f4050", "#f8ac59", "#ed5565", "#DD6D3F"],
      "nodes": {
        "c88df42d-7082-2709-5ad2-7cf9e1fa97cd": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4676,
            "y": 5160
          }
        },
        "140504b9-a300-0b4c-cf80-2c1b8eb07bc2": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 3860,
            "y": 5251
          }
        },
        "62890c24-2a94-c6ef-e068-136a914968b5": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4047,
            "y": 4575
          }
        },
        "8fe19680-d295-636d-c0c5-ce00b908ea1c": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 3937,
            "y": 5054
          }
        },
        "96470bf5-4a9e-472e-3e4b-59cf42153bbb": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 3793,
            "y": 4573
          }
        },
        "e6d42f1c-2589-a3d4-676b-df0c3b9b3bf7": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4594,
            "y": 5258
          }
        },
        "e9eec70d-55f1-0a51-ac73-8e40cef1f8b0": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 3940,
            "y": 4826
          }
        },
        "5169cfbd-079b-dfc1-ed05-73b4308d8a6b": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4114,
            "y": 5256
          }
        },
        "75a8c3fc-3ea6-853f-8c4e-c22c9d8128d9": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 3952,
            "y": 4956
          }
        },
        "9a1256c8-2453-658a-674a-b9bb0cc44751": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4347,
            "y": 5257
          }
        },
        "d59b610d-7c5a-255f-2b08-b7b84ce6215f": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4085,
            "y": 4683
          }
        },
        "702dbca8-1f0c-d30f-d2fc-ca583bdbd1c5": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4421,
            "y": 5161
          }
        },
        "d6d89982-bcf7-e65d-9df2-495cd8fc3876": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4286,
            "y": 4575
          }
        },
        "a74d1f41-61f5-1ddf-eac5-c6dd218ce8de": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4195,
            "y": 5101
          }
        },
        "759f34de-8bc0-9b0b-c72c-c78f103ddf1d": {
          "uiName": "",
          "color": "#00B1EB",
          "coordinates": {
            "x": 4195,
            "y": 4880
          }
        }
      }
    },
    "notebooks": {
      "140504b9-a300-0b4c-cf80-2c1b8eb07bc2": {
        "cells": [{
          "source": ["cls = dataframe()['class']\n", "pred = dataframe()['prediction']\n", "\n", "true = dataframe().filter(cls == pred)\n", "false = dataframe().filter(cls != pred)\n", "\n", "true_positives = true.filter(cls == True).count()\n", "true_negatives = true.filter(cls == False).count()\n", "false_positives = false.filter(cls == True).count()\n", "false_negatives = false.filter(cls == False).count()\n", "\n", "precision = true_positives / float(true_positives + false_positives)\n", "recall = true_positives / float(true_positives + false_negatives)\n", "f1 = 2 * precision * recall / (precision + recall)\n", "\n", "print true_positives, true_negatives, false_positives, false_negatives\n", "print precision, recall\n", "print f1\n"],
          "execution_count": 17,
          "outputs": [{
            "name": "stdout",
            "output_type": "stream",
            "text": ["196 1422 24 3\n", "0.890909090909 0.984924623116\n", "0.935560859189\n"]
          }],
          "cell_type": "code",
          "metadata": {
            "collapsed": false
          }
        }],
        "metadata": {
          "kernelspec": {
            "display_name": "pySpark",
            "language": "python",
            "name": "pyspark"
          },
          "language_info": {
            "mimetype": "text/x-python",
            "name": "python",
            "pygments_lexer": "ipython2",
            "codemirror_mode": {
              "name": "ipython",
              "version": 2
            },
            "version": "2.7.10",
            "nbconvert_exporter": "python",
            "file_extension": ".py"
          }
        },
        "nbformat": 4,
        "nbformat_minor": 0
      }
    }
  },
  "variables": {

  },
  "id": "c2bfd15e-b7d5-4b8d-876c-449e5248fa0c",
  "metadata": {
    "type": "batch",
    "apiVersion": "1.0.0"
  }
}
