#!/bin/bash
# Copyright (c) 2016, CodiLime Inc.

TEMPLATE=$1
TARGET=$2

DOCKER_REPOSITORY="docker-repo.deepsense.codilime.com/deepsense_io"
DOCKER_TAG="dev_upgrade_to_spark_2.0.0-latest"

EXPOSED_SM_PORT=60100
EXPOSED_MQ_PORT=60101
EXPOSED_MQ_WEBSOCKET_PORT=60102
EXPOSED_WM_PORT=60103
EXPOSED_DB_PORT=60104
EXPOSED_NOTEBOOK_PORT=60105
EXPOSED_FRONTEND_PORT=60106
EXPOSED_LIBRARY_PORT=60107

rm -f $TARGET
cp $TEMPLATE $TARGET

sed -i 's|\$DOCKER_REPOSITORY|'"$DOCKER_REPOSITORY"'|g' $TARGET
sed -i 's|\$DOCKER_TAG|'"$DOCKER_TAG"'|g' $TARGET
sed -i 's|\$EXPOSED_SM_PORT|'"$EXPOSED_SM_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_MQ_PORT|'"$EXPOSED_MQ_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_MQ_WEBSOCKET_PORT|'"$EXPOSED_MQ_WEBSOCKET_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_WM_PORT|'"$EXPOSED_WM_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_DB_PORT|'"$EXPOSED_DB_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_NOTEBOOK_PORT|'"$EXPOSED_NOTEBOOK_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_FRONTEND_PORT|'"$EXPOSED_FRONTEND_PORT"'|g' $TARGET
sed -i 's|\$EXPOSED_LIBRARY_PORT|'"$EXPOSED_LIBRARY_PORT"'|g' $TARGET
