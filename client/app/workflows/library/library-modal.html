<div class="dataframe-library-modal">
  <div class="modal-header dataframe-library-modal__header">
    <div class="title">Select Data Frame</div>
    <div class="input">
      <input class="form-control search-field"
             ng-model="controller.filterString"
             placeholder="Search in {{controller.currentDirName}}"
      />
    </div>
  </div>

  <breadcrumbs
    all-parents="controller.parents"
    current-folder="controller.currentDirName"
  ></breadcrumbs>

  <div class="dataframe-library-modal__body">
    <input
      multiple
      type="file"
      id="uploader-input"
      style="display: none;"
      file-upload-change="controller.onFileSelectedHandler"
    >

    <div class="content-wrapper">
      <div class="directories-list">
        <div class="directories-list__parents">
          <div class="entry parent"
               ng-repeat="folder in controller.parents track by $index"
               ng-click="controller.getFilesForUri(folder.uri)"
          >
            {{folder.name}}
          </div>
          <div class="entry parent">
            {{controller.currentDirName}}
          </div>
        </div>

        <div class="directories-list__directories">
          <div class="entry sa sa-up-level"
               ng-if="controller.parents.length > 0"
               ng-click="controller.goToParentDirectory()">
          </div>

          <div class="entry"
               ng-repeat="directory in controller.directories track by $index"
               ng-click="controller.getFilesForUri(directory.uri)">
            {{directory.name}}
          </div>
        </div>
      </div>

      <div class="files-list">
        <div class="dataframe-form">
          <div class="current-directory">
            {{controller.currentDir}}
          </div>
          <div class="add-file">
            <button class="btn btn-grey" ng-click="controller.openFileBrowser()">
              <i class="fa fa-plus"></i>
              <span>Add file</span>
            </button>
          </div>
          <div class="drop-area"
               ng-click="controller.openFileBrowser()"
               dropzone-file-upload="controller.onFileSelectedHandler">
            Drag new files here
          </div>
        </div>

        <div class="dataframe-upload-progress" ng-if="controller.uploadingFiles.length > 0">
          <div ng-repeat="uploadingFile in controller.uploadingFiles track by uploadingFile.path">
            <div class="title"><b>{{uploadingFile.path}}</b></div>
            <div class="uploading-section">
              <div class="information">uploading...</div>
              <div class="progress">
                <uib-progressbar
                  class="progress-striped active"
                  animate="true"
                  value="uploadingFile.progress"
                  type="info">
                </uib-progressbar>
              </div>
            </div>
          </div>
        </div>

        <div class="list-wrapper uploaded-list-wrapper" ng-if="controller.uploadedFiles">
          <div class="dataframe" ng-repeat="dataframe in controller.uploadedFiles track by dataframe.path">
            <div class="dataframe-name"
                 ng-click="controller.selectDataframe(dataframe)"
                 ng-class="{'selectable-dataframe': controller.canChooseDataframe}">
              <span>{{dataframe.path}}</span>
              <span class="dataframe-uploaded">uploaded</span>
            </div>
            <div class="actions">
              <a ng-href={{dataframe.downloadUrl}} download><span class="sa sa-download"></span></a>
              <span class="sa sa-delete" ng-click="controller.deleteUploadedFile(dataframe)"></span>
            </div>
          </div>
        </div>

        <div class="dataframe-list" ng-if="!controller.filterString">
          <div class="list-wrapper" custom-scroll-bar>
            <deepsense-loading-spinner-sm ng-if="controller.loading"></deepsense-loading-spinner-sm>

            <div class="dataframe"
                 ng-repeat="dataframe in controller.files">
              <div class="dataframe-name"
                   ng-click="controller.selectDataframe(dataframe)"
                   ng-class="{'selectable-dataframe': controller.canChooseDataframe}">
                <span>{{dataframe.name}}</span>
              </div>
              <div class="actions">
                <a ng-href={{dataframe.downloadUrl}} download><span class="sa sa-download"></span></a>
                <span class="sa sa-delete" ng-click="controller.deleteFile(dataframe)"></span>
              </div>
            </div>

            <div ng-if="controller.message" class="dataframe-info">
              {{controller.message}}
            </div>

          </div>
        </div>

        <div class="dataframe-list" ng-if="controller.filterString">
          <div class="list-wrapper" custom-scroll-bar>
            <deepsense-loading-spinner-sm ng-if="controller.loading"></deepsense-loading-spinner-sm>

            <div ng-repeat="folder in controller.searchResults" class="folder">
              {{folder.name}}
              <div class="dataframe"
                   ng-repeat="dataframe in folder.items ">

                <div class="dataframe-name"
                     ng-click="controller.selectDataframe(dataframe)"
                     ng-class="{'selectable-dataframe': controller.canChooseDataframe}">
                  <span>{{dataframe.name}}</span>
                </div>
                <div class="actions">
                  <a ng-href={{dataframe.downloadUrl}} download><span class="sa sa-download"></span></a>
                  <span class="sa sa-delete" ng-click="controller.deleteFile(dataframe)"></span>
                </div>
              </div>

              <div ng-if="controller.searchResults.length <= 1 && controller.searchResults[0].items.length < 1" class="dataframe-info">
                There is no search results in this folder.
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="dataframe-library-modal__footer">
    <button type="button" class="btn btn-white" ng-click="controller.close()">Close</button>
  </div>
</div>
